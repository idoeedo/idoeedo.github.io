/* =============================================================================
    Variables & Theme
============================================================================= */

:root {

  /* Typography: Font Size */
  --fs-base: 1rem;
  --fs-code: 0.85rem;
  --fs-h1: 1.875rem;
  --fs-h2: 1.5rem;
  --fs-h3: 1.25rem;
  --fs-toc: 0.9rem;
  --fs-figcaption: 0.9rem;

  /* Typography: Line Height */
  --lh-base: 1.65;
  --lh-tight: 1.3;

  /* Layout Dimensions */
  --main-width: 720px;    /* 기존 변수 */
  --gap: 24px;            /* 기존 변수 */
  --header-height: 70px;
  --gap-content-p: 16px;

  /* Palette: Gold */
  --color-gold-1: #FFF1C2;
  --color-gold-2: #FDB515;
  --color-gold-3: #FC9313;
  --color-gold-4: #E3740A;
  --color-gold-5: #B55A00;

  /* Palette: Blue */
  --color-blue-1: #D4E3FF;
  --color-blue-2: #8EBBFF;
  --color-blue-3: #3F7EE8;
  --color-blue-4: #174AA8;
  --color-blue-5: #002676;

  /* Palette: Red */
  --color-red-1: #FFE2E0;
  --color-red-2: #FFB3A8;
  --color-red-3: #FF6F61;
  --color-red-4: #E5483F;
  --color-red-5: #B71C1C;

  /* Palette: Gray */
  --color-gray-1:#F5F5F5;
  --color-gray-2:#E0E0E0;
  --color-gray-3:#BDBDBD;
  --color-gray-4:#757575;
  --color-gray-5:#424242;

  /* Semantic Colors */
  --color-inline-code-text: #EB5757;                 /* 노션 색상 */
  --color-inline-code-bg: rgba(135, 131, 120, .15);  /* 노션 색상 */
  --color-figcaption: var(--color-gray-4);
  --color-link: var(--color-blue-3);
  --color-link-hover: var(--color-gold-2);
  --color-toc-bar: var(--color-gray-4);
  --color-toc-bar-active: var(--color-gold-2);
  --color-toc-divider: var(--color-gray-3);
}

[data-theme="dark"] {
  --color-inline-code-bg: rgba(135, 131, 120, .25);
  --color-figcaption: var(--color-gray-3);
  --color-link: var(--color-blue-2);
  --color-toc-divider: var(--color-gray-5);
}


/* =============================================================================
    Global & Base Styles
============================================================================= */

body {
  font-size: var(--fs-base);
  line-height: var(--lh-base);
  word-break: keep-all;
}

/* -------------------------------
    Headings
------------------------------- */
:is(h1, h2, h3, h4, h5, h6) {
    line-height: var(--lh-tight);
}

:is(h1, .first-entry .entry-header h1, .post-title) {
  font-size: var(--fs-h1);
  margin-bottom: 1rem;
}

:is(h2, .post-content h2) {
  font-size: var(--fs-h2);
  scroll-margin-top: calc(var(--header-height) + 10px);
}

:is(h3, .post-content h3) {
  font-size: var(--fs-h3);
  scroll-margin-top: calc(var(--header-height) + 10px);
}

/* -------------------------------
    Header
------------------------------- */
.header  {
  position: sticky;
  top: 0;
  z-index: 1000;
  background-color: inherit;
}

.first-entry { 
  min-height: auto; 
}

.entry-footer {
  margin-top: 10px;
}


/* =============================================================================
    Component: Post Content
============================================================================= */

.post-content { 

  /* -------------------------------
      Paragraphs
  ------------------------------- */
  & p {
    text-indent: 0.7rem;
    margin-block: var(--gap-content-p);
  }

  /* -------------------------------
      Headings Styles inside content
  ------------------------------- */
  & h4 { 
    margin-top: 3rem; 
  }

  /* -------------------------------
      Links
  ------------------------------- */
  & a {
    box-shadow: none;
    color: var(--color-link); 
    transition: color 0.1s;

    &:hover {
      color: var(--color-link-hover);
      text-decoration: underline;
    }
  }

  /* -------------------------------
      Horizontal Rule
  ------------------------------- */
  & hr {
    margin: 3rem 0;
  }

  /* -------------------------------
      Inline Code
  ------------------------------- */
  & code {
    margin: 0 0.2rem;
    padding: 0.2em 0.4em;
    border-radius: 4px;
    font-size: var(--fs-code);
    background: var(--color-inline-code-bg);
    color: var(--color-inline-code-text);
  }

  /* -------------------------------
      Image & Figures
  ------------------------------- */
  & figure {
    margin: 2rem 0;
    text-align: center;

    & > figcaption {
      color: var(--color-figcaption);
      font-size: var(--fs-figcaption);
      font-weight: 400;
    }
  }

  & img {
    border-radius: 10px;
    display: block;
    margin-left: auto;
    margin-right: auto;
  }

  /* -------------------------------
      Anchor Links
  ------------------------------- */
  & :is(h2, h3) {
    display: flex;
    gap: 0.35rem;

    & .anchor {
      display: inline-block;
      margin: 0;
      padding: 0;
      order: -1;
      color: var(--color-blue-3);
      font-weight: inherit;

      &:hover {
        color: var(--color-link-hover);
      }
    }
  }

  /* -------------------------------
      Note
  ------------------------------- */
  & .note {
    padding: 16px;
    margin: 1.5rem 0;
    border-radius: 5px;
    display: flex;
    flex-direction: row;
    background-color: var(--entry);
    border: 1px solid rgba(0, 0, 0, 0.1);


    & .note-icon {
      margin-right: 12px;
      font-size: 1.25rem;
      height: 1.5rem;
      display: flex;
      align-items: center;
      user-select: none;
      flex-shrink: 0;
    }

    & .note-wrapper {
      display: flex;
      flex-direction: column;
      flex: 1;
      min-width: 0;
    }

    & .note-title {
      font-weight: 700;
      margin-bottom: 10px; /* 내용과의 간격 */
      line-height: 1.5;
      font-size: 1rem;
    }

    & .note-content {
      line-height: 1.6;
      margin: 0;
      overflow-wrap: anywhere;
      word-break: break-word;
    }

    & .note-content p {
      margin: 0;
      text-indent: 0;
    }

    & .note-content p + p {
      margin-top: 0.5rem;
    }
  }
}


/* =============================================================================
    Component: Table of Contents (TOC)
============================================================================= */

.toc {
  font-size: var(--fs-toc);
  line-height: var(--lh-base);
  border: none;

  & ul {
    list-style: none;
    margin: 0;
    padding: 0;
  }

  & a {
    box-shadow: none;
    text-decoration: none;
    position: relative;
    display: inline-block;
    padding-left: 0.6rem;
    transition: all 0.1s;

    /* Active Indicator Bar */
    &::before {
      content: "";
      position: absolute;
      inset-inline-start: 0;
      inset-block-start: 0.25rem;
      inline-size: 3px;
      block-size: 0.9rem;
      background: var(--color-toc-bar);
      border-radius: 1px;
    }

    &:hover {
      box-shadow: none;
      color: var(--color-link-hover);
    }

    &:focus-visible {
      outline: 2px solid currentColor;
      outline-offset: 2px;
    }

    &.active {
      font-weight: 800;
      &::before {
        background: var(--color-toc-bar-active);
      }
    }
  }

  /* Desktop Layout */
  @media (min-width: 992px) {
    position: fixed;
    background: transparent !important;

    /* Complex calc based on main width */
    inset-inline-start: min(80vw, calc(50vw + (var(--main-width) / 2) + var(--gap)));
    max-inline-size: max(calc(20vw) - (var(--gap) / 2), ((100vw - var(--main-width)) / 2) - (var(--gap) * 1.5));
    inset-block-start: calc(var(--header-height) + (var(--gap) * 2));
    border-inline-start: 4px solid var(--color-toc-divider);
    border-radius: 0;

    & details[open] > summary { 
      display: none; 
    }

    & .inner { 
      margin: 0; 
    }
    
    /* Auto-folding logic */
    & ul ul { 
      display: none; 
    }

    @supports selector(:has(*)) {
      & li:has(> a.active) > ul,
      & li:has(ul a.active) > ul {
        display: block;
      }
    }
  }
}


/* =============================================================================
    Layout Adjustment
============================================================================= */

.main {
  width: 100%; /* Mobile Default */

  @media (min-width: 992px) {
    width: 60%;
  }
}


/* ============================================================================
    A11y: Reduced Motion
============================================================================ */

@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.001ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.001ms !important;
    scroll-behavior: auto !important;
  }
}